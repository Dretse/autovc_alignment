2021-07-30 10:36:50,772 - INFO - 
*********************************
Dataset options
*********************************

2021-07-30 10:36:50,775 - INFO - batch_size: 128
data_file_extension: .wav
data_path: /ssd/data/VoxCeleb/vox2_dev_wav/wav
dataset_csv: data/voxceleb2_dev_fixed_half1.csv
sample_rate: 16000
stratify: false
test:
  data_path: /ssd/data/VoxCeleb/vox1_test_wav/wav
  idmap: h5f/vox1_test_cleaned_idmap.h5
  key: h5f/vox1_test_cleaned_key.h5
  ndx: h5f/vox1_test_cleaned_ndx.h5
train:
  chunk_per_segment: -1
  duration: 2
  overlap: 2
  sampler:
    augmentation_replica: 1
    examples_per_speaker: 1
    samples_per_speaker: 128
  transform_number: 1
  transformation:
    add_noise:
      data_path: /ssd/data/musan_original
      noise_db_csv: data/musan_original.csv
    add_reverb:
      data_path: /ssd/data/simulated_rirs
      rir_db_csv: data/simulated_rirs.csv
    pipeline: add_reverb,add_noise,phone_filtering,codec
valid:
  duration: 2
  transformation:
    add_noise:
      data_path: /ssd/data/musan_original
      noise_db_csv: data/musan_original.csv
    add_reverb:
      data_path: ''
      noise_db_csv: ''
    pipeline: ''
validation_ratio: 0.02

2021-07-30 10:36:50,775 - INFO - 
*********************************
Model options
*********************************

2021-07-30 10:36:50,776 - INFO - freeze_parts: []
initial_model_name: null
loss:
  aam_margin: O.2
  aam_s: 30
  type: aam
model_type: halfresnet34
preprocessor:
  feature_size: 80
  type: mel_spec
reset_parts: []
speaker_number: 2997

2021-07-30 10:36:50,776 - INFO - 
*********************************
Training options
*********************************

2021-07-30 10:36:50,778 - INFO - best_model_name: models/best_model_2s_cuda_0.pt
checkpoint_frequency: 10
clipping: false
compute_test_eer: true
deterministic: false
epochs: 1000
log_file: logs/training_resnet_0.log
log_interval: 461
lr: 0.001
mixed_precision: true
multi_gpu: false
num_cpu: 5
numpy_seed: 0
optimizer:
  options: null
  type: adam
patience: 100
random_seed: 0
scheduler:
  options: null
  type: CyclicLR
tmp_model_name: models/tmp_model_2s_cuda_0.pt
torch_seed: 0
validation_frequency: 1

2021-07-30 10:39:01,879 - INFO - 
*********************************
Dataset options
*********************************

2021-07-30 10:39:01,881 - INFO - batch_size: 128
data_file_extension: .wav
data_path: /ssd/data/VoxCeleb/vox2_dev_wav/wav
dataset_csv: data/voxceleb2_dev_fixed_half1.csv
sample_rate: 16000
stratify: false
test:
  data_path: /ssd/data/VoxCeleb/vox1_test_wav/wav
  idmap: h5f/vox1_test_cleaned_idmap.h5
  key: h5f/vox1_test_cleaned_key.h5
  ndx: h5f/vox1_test_cleaned_ndx.h5
train:
  chunk_per_segment: -1
  duration: 2
  overlap: 2
  sampler:
    augmentation_replica: 1
    examples_per_speaker: 1
    samples_per_speaker: 128
  transform_number: 1
  transformation:
    add_noise:
      data_path: /ssd/data/musan_original
      noise_db_csv: data/musan_original.csv
    add_reverb:
      data_path: /ssd/data/simulated_rirs
      rir_db_csv: data/simulated_rirs.csv
    pipeline: add_reverb,add_noise,phone_filtering,codec
valid:
  duration: 2
  transformation:
    add_noise:
      data_path: /ssd/data/musan_original
      noise_db_csv: data/musan_original.csv
    add_reverb:
      data_path: ''
      noise_db_csv: ''
    pipeline: ''
validation_ratio: 0.02

2021-07-30 10:39:01,881 - INFO - 
*********************************
Model options
*********************************

2021-07-30 10:39:01,882 - INFO - freeze_parts: []
initial_model_name: null
loss:
  aam_margin: O.2
  aam_s: 30
  type: aam
model_type: halfresnet34
preprocessor:
  feature_size: 80
  type: mel_spec
reset_parts: []
speaker_number: 2997

2021-07-30 10:39:01,882 - INFO - 
*********************************
Training options
*********************************

2021-07-30 10:39:01,884 - INFO - best_model_name: models/best_model_2s_cuda_0.pt
checkpoint_frequency: 10
clipping: false
compute_test_eer: true
deterministic: false
epochs: 1000
log_file: logs/training_resnet_0.log
log_interval: 461
lr: 0.001
mixed_precision: true
multi_gpu: false
num_cpu: 5
numpy_seed: 0
optimizer:
  options: null
  type: adam
patience: 100
random_seed: 0
scheduler:
  options: null
  type: CyclicLR
tmp_model_name: models/tmp_model_2s_cuda_0.pt
torch_seed: 0
validation_frequency: 1

2021-07-30 10:41:57,111 - INFO - Start training process
2021-07-30 10:41:57,111 - INFO - Use 	1 	gpus
2021-07-30 10:41:57,111 - INFO - Use 	5 	cpus
2021-07-30 10:41:57,111 - INFO - Validation EER will be measured using
2021-07-30 10:41:57,232 - INFO - 	 32937 target trials and
2021-07-30 10:41:57,364 - INFO - 	 32858 non-target trials
2021-07-30 10:42:02,353 - INFO - Epoch: 1 [1/2997 (0%)]	Loss: 15.535729	Accuracy: 0.000
2021-07-30 10:44:57,739 - INFO - Epoch: 1 [462/2997 (15%)]	Loss: 14.823574	Accuracy: 0.027
2021-07-30 10:47:53,812 - INFO - Epoch: 1 [923/2997 (31%)]	Loss: 14.121752	Accuracy: 0.027
2021-07-30 10:50:49,996 - INFO - Epoch: 1 [1384/2997 (46%)]	Loss: 14.030828	Accuracy: 0.020
2021-07-30 10:53:46,154 - INFO - Epoch: 1 [1845/2997 (62%)]	Loss: 13.840117	Accuracy: 0.029
2021-07-30 10:56:42,277 - INFO - Epoch: 1 [2306/2997 (77%)]	Loss: 13.580098	Accuracy: 0.058
2021-07-30 10:59:38,395 - INFO - Epoch: 1 [2767/2997 (92%)]	Loss: 13.435667	Accuracy: 0.130
2021-07-30 13:39:01,354 - INFO - 
*********************************
Dataset options
*********************************

2021-07-30 13:39:01,357 - INFO - batch_size: 128
data_file_extension: .wav
data_path: /ssd/data/VoxCeleb/vox2_dev_wav/wav
dataset_csv: data/voxceleb2_dev_fixed_half1.csv
sample_rate: 16000
stratify: false
test:
  data_path: /ssd/data/VoxCeleb/vox1_test_wav/wav
  idmap: h5f/vox1_test_cleaned_idmap.h5
  key: h5f/vox1_test_cleaned_key.h5
  ndx: h5f/vox1_test_cleaned_ndx.h5
train:
  chunk_per_segment: -1
  duration: 2
  overlap: 2
  sampler:
    augmentation_replica: 1
    examples_per_speaker: 1
    samples_per_speaker: 128
  transform_number: 1
  transformation:
    add_noise:
      data_path: /ssd/data/musan_original
      noise_db_csv: data/musan_original.csv
    add_reverb:
      data_path: /ssd/data/simulated_rirs
      rir_db_csv: data/simulated_rirs.csv
    pipeline: add_reverb,add_noise,phone_filtering,codec
valid:
  duration: 2
  transformation:
    add_noise:
      data_path: /ssd/data/musan_original
      noise_db_csv: data/musan_original.csv
    add_reverb:
      data_path: ''
      noise_db_csv: ''
    pipeline: ''
validation_ratio: 0.02

2021-07-30 13:39:01,357 - INFO - 
*********************************
Model options
*********************************

2021-07-30 13:39:01,358 - INFO - freeze_parts: []
initial_model_name: null
loss:
  aam_margin: O.2
  aam_s: 30
  type: aam
model_type: halfresnet34
preprocessor:
  feature_size: 80
  type: mel_spec
reset_parts: []
speaker_number: 2997

2021-07-30 13:39:01,358 - INFO - 
*********************************
Training options
*********************************

2021-07-30 13:39:01,360 - INFO - best_model_name: models/best_model_2s_cuda_0.pt
checkpoint_frequency: 10
clipping: false
compute_test_eer: true
deterministic: false
epochs: 64
log_file: logs/training_resnet_0.log
log_interval: 461
lr: 0.001
mixed_precision: true
multi_gpu: false
num_cpu: 5
numpy_seed: 0
optimizer:
  options: null
  type: adam
patience: 100
random_seed: 0
scheduler:
  options: null
  type: CyclicLR
tmp_model_name: models/tmp_model_2s_cuda_0.pt
torch_seed: 0
validation_frequency: 1

2021-07-30 13:41:54,260 - INFO - Start training process
2021-07-30 13:41:54,260 - INFO - Use 	2 	gpus
2021-07-30 13:41:54,261 - INFO - Use 	5 	cpus
2021-07-30 13:41:54,261 - INFO - Validation EER will be measured using
2021-07-30 13:41:54,380 - INFO - 	 32937 target trials and
2021-07-30 13:41:54,499 - INFO - 	 32858 non-target trials
2021-07-30 13:41:59,701 - INFO - Epoch: 1 [1/1498 (0%)]	Loss: 15.395390	Accuracy: 0.000
2021-07-30 13:44:54,503 - INFO - Epoch: 1 [462/1498 (31%)]	Loss: 14.638782	Accuracy: 0.032
2021-07-30 13:47:50,272 - INFO - Epoch: 1 [923/1498 (62%)]	Loss: 14.051380	Accuracy: 0.041
2021-07-30 13:50:46,120 - INFO - Epoch: 1 [1384/1498 (92%)]	Loss: 13.864758	Accuracy: 0.036
